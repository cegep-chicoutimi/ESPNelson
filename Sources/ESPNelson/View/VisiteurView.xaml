<Page x:Class="ESPNelson.View.VisiteurView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      xmlns:vm="clr-namespace:ESPNelson.ViewModel"
      Title="VisiteurView"
      Background="White">

    <!-- Liaison du ViewModel -->
    <Page.DataContext>
        <vm:VisiteurVM />
    </Page.DataContext>

    <Grid>
        <!-- Définir les lignes pour organiser les éléments -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!-- Titre -->
            <RowDefinition Height="Auto" />
            <!-- Carte du ticket -->
            <RowDefinition Height="Auto" />
            <!-- Boutons -->
            <RowDefinition Height="*" />
            <!-- Espace vide -->
        </Grid.RowDefinitions>

        <!-- Titre de la page -->
        <TextBlock
            Grid.Row="0"
            Style="{StaticResource MaterialDesignHeadline4TextBlock}"
            Text="Génération de Ticket Visiteur"
            HorizontalAlignment="Center"
            Margin="0,20,0,10" />

        <!-- Carte pour afficher les informations du ticket -->
        <materialDesign:Card
            Grid.Row="1"
            Padding="16"
            Margin="16"
            HorizontalAlignment="Center"
            Width="400">
            <StackPanel>
                <!-- Numéro du ticket -->
                <TextBlock
                    Style="{StaticResource MaterialDesignSubtitle1TextBlock}"
                    Text="{Binding TicketActuel.Id, StringFormat='Numéro du ticket : {0}'}"
                    Margin="0,0,0,10"
                    HorizontalAlignment="Center" />

                <!-- Date et heure d'arrivée -->
                <TextBlock
                    Style="{StaticResource MaterialDesignBody1TextBlock}"
                    Text="{Binding TicketActuel.TempsArrive, StringFormat='Date et heure d\'arrivée : {0:dd/MM/yyyy HH:mm:ss}'}"
                    Margin="0,0,0,10"
                    HorizontalAlignment="Center" />

                <!-- Code-barres -->
                <Image
                    Source="{Binding BarcodeImage}"
                    Width="300"
                    Height="100"
                    Margin="0,10,0,20"
                    HorizontalAlignment="Center" />
            </StackPanel>
        </materialDesign:Card>

        <!-- Boutons pour les actions -->
        <StackPanel
            Grid.Row="2"
            Orientation="Horizontal"
            HorizontalAlignment="Center"
            Margin="0,20,0,0">
            <!-- Bouton pour générer un nouveau ticket -->
            <Button
                Command="{Binding GenerateNewTicketCommand}"
                Style="{StaticResource MaterialDesignRaisedButton}"
                Margin="10"
                Padding="16,8"
                HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Ticket" Width="24" Height="24" Margin="0,0,8,0" />
                    <TextBlock Text="Générer un ticket" VerticalAlignment="Center" />
                </StackPanel>
            </Button>

            <!-- Bouton pour télécharger le ticket en PDF -->
            <Button
                Command="{Binding DownloadTicketPDFCommand}"
                Style="{StaticResource MaterialDesignRaisedButton}"
                Margin="10"
                Padding="16,8"
                HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Download" Width="24" Height="24" Margin="0,0,8,0" />
                    <TextBlock Text="Télécharger le ticket" VerticalAlignment="Center" />
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</Page>